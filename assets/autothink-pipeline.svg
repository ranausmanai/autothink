<svg width="1400" height="820" viewBox="0 0 1400 820" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="title desc">
  <title id="title">AutoThink Training and Prediction Pipeline</title>
  <desc id="desc">Flowchart from input dataframe through task detection, preprocessing, feature engineering, ensemble training, blend optimization, verification, and prediction.</desc>

  <defs>
    <linearGradient id="bgGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f7fbff"/>
      <stop offset="100%" stop-color="#edf7f3"/>
    </linearGradient>
    <linearGradient id="titleGrad" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#0f172a"/>
      <stop offset="100%" stop-color="#1f3a5f"/>
    </linearGradient>
    <linearGradient id="boxBlue" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#e8f2ff"/>
      <stop offset="100%" stop-color="#dbeafe"/>
    </linearGradient>
    <linearGradient id="boxGreen" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#e9fbf2"/>
      <stop offset="100%" stop-color="#d1fae5"/>
    </linearGradient>
    <linearGradient id="boxAmber" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#fff8e7"/>
      <stop offset="100%" stop-color="#ffedd5"/>
    </linearGradient>
    <linearGradient id="boxPurple" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f5f3ff"/>
      <stop offset="100%" stop-color="#ede9fe"/>
    </linearGradient>
    <linearGradient id="boxSlate" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f8fafc"/>
      <stop offset="100%" stop-color="#e2e8f0"/>
    </linearGradient>
    <linearGradient id="predictGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0b3a4b"/>
      <stop offset="100%" stop-color="#0f766e"/>
    </linearGradient>
    <marker id="arrow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L12,6 L0,12 z" fill="#1e293b" />
    </marker>
    <filter id="softShadow" x="-20%" y="-20%" width="140%" height="160%">
      <feDropShadow dx="0" dy="6" stdDeviation="8" flood-color="#0f172a" flood-opacity="0.12"/>
    </filter>
  </defs>

  <rect x="0" y="0" width="1400" height="820" fill="url(#bgGrad)"/>
  <circle cx="1260" cy="120" r="220" fill="#dbeafe" opacity="0.35"/>
  <circle cx="130" cy="710" r="180" fill="#d1fae5" opacity="0.3"/>

  <text x="700" y="82" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="42" font-weight="700" fill="url(#titleGrad)">AutoThink End-to-End Pipeline</text>
  <text x="700" y="120" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="21" fill="#334155">From raw tabular data to calibrated ensemble predictions</text>

  <!-- Input -->
  <rect x="95" y="210" rx="22" ry="22" width="260" height="128" fill="#ffffff" stroke="#cbd5e1" stroke-width="2" filter="url(#softShadow)"/>
  <text x="225" y="266" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="30" font-weight="700" fill="#0f172a">Your DataFrame</text>
  <text x="225" y="300" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="18" fill="#475569">train_df + target</text>

  <!-- Top row boxes -->
  <rect x="440" y="190" rx="20" ry="20" width="280" height="165" fill="url(#boxBlue)" stroke="#93c5fd" stroke-width="2" filter="url(#softShadow)"/>
  <text x="580" y="240" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="29" font-weight="700" fill="#0f172a">Task Detection</text>
  <text x="580" y="274" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="17" fill="#1e3a8a">binary / multiclass / regression</text>
  <text x="580" y="302" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#334155">metric and objective inferred</text>

  <rect x="780" y="190" rx="20" ry="20" width="280" height="165" fill="url(#boxGreen)" stroke="#86efac" stroke-width="2" filter="url(#softShadow)"/>
  <text x="920" y="240" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="29" font-weight="700" fill="#0f172a">Preprocessing</text>
  <text x="920" y="274" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="17" fill="#166534">missing values, encoding, scaling</text>
  <text x="920" y="302" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#334155">type-aware transforms applied</text>

  <rect x="1120" y="190" rx="20" ry="20" width="240" height="165" fill="url(#boxAmber)" stroke="#fdba74" stroke-width="2" filter="url(#softShadow)"/>
  <text x="1240" y="240" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="29" font-weight="700" fill="#0f172a">Feature</text>
  <text x="1240" y="274" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="29" font-weight="700" fill="#0f172a">Engineering</text>
  <text x="1240" y="302" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#7c2d12">thresholds + interactions</text>

  <!-- Bottom row boxes -->
  <rect x="1120" y="460" rx="20" ry="20" width="240" height="165" fill="url(#boxPurple)" stroke="#c4b5fd" stroke-width="2" filter="url(#softShadow)"/>
  <text x="1240" y="510" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="27" font-weight="700" fill="#0f172a">Ensemble</text>
  <text x="1240" y="542" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="27" font-weight="700" fill="#0f172a">Training</text>
  <text x="1240" y="574" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#5b21b6">LightGBM + XGBoost + CatBoost</text>

  <rect x="780" y="460" rx="20" ry="20" width="280" height="165" fill="url(#boxBlue)" stroke="#93c5fd" stroke-width="2" filter="url(#softShadow)"/>
  <text x="920" y="510" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="28" font-weight="700" fill="#0f172a">Blend Optimization</text>
  <text x="920" y="544" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#1e3a8a">scipy optimized weights</text>
  <text x="920" y="572" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#1e3a8a">+ Platt calibration</text>

  <rect x="440" y="460" rx="20" ry="20" width="280" height="165" fill="url(#boxSlate)" stroke="#94a3b8" stroke-width="2" filter="url(#softShadow)"/>
  <text x="580" y="510" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="29" font-weight="700" fill="#0f172a">Verification</text>
  <text x="580" y="544" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#334155">fold stability checks</text>
  <text x="580" y="572" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="16" fill="#334155">leakage and drift diagnostics</text>

  <!-- Final prediction node -->
  <rect x="95" y="676" rx="22" ry="22" width="420" height="92" fill="url(#predictGrad)" stroke="#0f766e" stroke-width="2" filter="url(#softShadow)"/>
  <text x="305" y="735" text-anchor="middle" font-family="Consolas, Menlo, Monaco, monospace" font-size="27" font-weight="700" fill="#ecfeff">model.predict(test_df)</text>

  <!-- Arrows -->
  <path d="M355 274 L428 274" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>
  <path d="M720 274 L768 274" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>
  <path d="M1060 274 L1108 274" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>

  <path d="M1240 356 L1240 448" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>

  <path d="M1120 543 L1072 543" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>
  <path d="M780 543 L732 543" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>

  <path d="M440 543 C 350 543, 330 610, 305 666" stroke="#1e293b" stroke-width="4" fill="none" marker-end="url(#arrow)"/>

  <!-- Section tags -->
  <rect x="108" y="170" rx="10" ry="10" width="176" height="30" fill="#e2e8f0"/>
  <text x="196" y="191" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="14" font-weight="700" fill="#334155">INPUT</text>

  <rect x="492" y="155" rx="10" ry="10" width="320" height="30" fill="#dbeafe"/>
  <text x="652" y="176" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="14" font-weight="700" fill="#1e3a8a">ADAPTIVE TRAINING PIPELINE</text>

  <rect x="120" y="637" rx="10" ry="10" width="160" height="30" fill="#ccfbf1"/>
  <text x="200" y="658" text-anchor="middle" font-family="Segoe UI, Helvetica, Arial, sans-serif" font-size="14" font-weight="700" fill="#0f766e">OUTPUT</text>
</svg>
